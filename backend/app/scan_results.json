{"SCAN-c42d5adc111b": {"status": "completed", "result": {"scan_id": "SCAN-c42d5adc111b", "repo_path": "C:\\Users\\MSI PC\\Workspace\\DevSecOps Automation Project\\ThreatModelerX\\demo-apps\\python-flask", "timestamp": "2025-11-20T05:47:24.067281", "findings": [{"id": "BANDIT-0e3827c8", "tool": "bandit", "language": "python", "file": "app.py", "line": 45, "cwe": "CWE-78", "severity": "HIGH", "description": "Starting a process with a shell, possible injection detected, security issue. (Test: start_process_with_a_shell)", "evidence": "44     cmd = request.args.get('cmd', 'ls')\n45     result = os.system(f\"echo {cmd}\")\n46     return jsonify({\"output\": result})\n", "fix_suggestion": "https://bandit.readthedocs.io/en/1.9.1/plugins/b605_start_process_with_a_shell.html", "risk_score": 16.2, "component": null, "status": "OPEN", "manual_review": {}, "reviewer_comments": [], "created_at": "2025-11-20T05:46:48.767119", "updated_at": null}, {"id": "BANDIT-23ede76f", "tool": "bandit", "language": "python", "file": "app.py", "line": 51, "cwe": "CWE-78", "severity": "HIGH", "description": "subprocess call with shell=True identified, security issue. (Test: subprocess_popen_with_shell_equals_true)", "evidence": "50     filename = request.args.get('file', 'test.txt')\n51     output = subprocess.check_output(f\"cat {filename}\", shell=True)\n52     return jsonify({\"content\": output.decode()})\n", "fix_suggestion": "https://bandit.readthedocs.io/en/1.9.1/plugins/b602_subprocess_popen_with_shell_equals_true.html", "risk_score": 16.2, "component": null, "status": "OPEN", "manual_review": {}, "reviewer_comments": [], "created_at": "2025-11-20T05:46:48.767242", "updated_at": null}, {"id": "RETIRE-MOCK-1", "tool": "retire.js", "language": null, "file": "C:\\Users\\MSI PC\\Workspace\\DevSecOps Automation Project\\ThreatModelerX\\demo-apps\\python-flask\\node_modules\\jquery\\dist\\jquery.js", "line": 1, "cwe": "CWE-79", "severity": "HIGH", "description": "jQuery 1.8.1 vulnerable to XSS attacks", "evidence": null, "fix_suggestion": "Update jQuery to version 3.5.0 or later", "risk_score": 14.4, "component": null, "status": "OPEN", "manual_review": {}, "reviewer_comments": [], "created_at": "2025-11-20T05:46:45.163503", "updated_at": null}, {"id": "SEMGREP-78e60397", "tool": "semgrep", "language": "sqlalchemy", "file": "app.py", "line": 25, "cwe": "CWE-CWE-704: Incorrect Type Conversion or Cast", "severity": "HIGH", "description": "Detected user input used to manually construct a SQL string. This is usually bad practice because manual construction could accidentally result in a SQL injection. An attacker could use a SQL injection to steal or modify contents of the database. Instead, use a parameterized query which is available by default in most database engines. Alternatively, consider using an object-relational mapper (ORM) such as SQLAlchemy which will protect your queries.", "evidence": "requires login", "fix_suggestion": "Review and fix the security issue", "risk_score": 9.0, "component": null, "status": "OPEN", "manual_review": {}, "reviewer_comments": [], "created_at": "2025-11-20T05:47:22.800486", "updated_at": null}, {"id": "SEMGREP-ca314ccf", "tool": "semgrep", "language": "sqlalchemy", "file": "app.py", "line": 26, "cwe": "CWE-CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')", "severity": "HIGH", "description": "Avoiding SQL string concatenation: untrusted input concatenated with raw SQL query can result in SQL Injection. In order to execute raw query safely, prepared statement should be used. SQLAlchemy provides TextualSQL to easily used prepared statement with named parameters. For complex SQL composition, use SQL Expression Language or Schema Definition Language. In most cases, SQLAlchemy ORM will be a better option.", "evidence": "requires login", "fix_suggestion": "Review and fix the security issue", "risk_score": 9.0, "component": null, "status": "OPEN", "manual_review": {}, "reviewer_comments": [], "created_at": "2025-11-20T05:47:22.801017", "updated_at": null}, {"id": "SEMGREP-87a71760", "tool": "semgrep", "language": "django", "file": "app.py", "line": 36, "cwe": "CWE-CWE-915: Improperly Controlled Modification of Dynamically-Determined Object Attributes", "severity": "HIGH", "description": "Detected user input used to manually construct a SQL string. This is usually bad practice because manual construction could accidentally result in a SQL injection. An attacker could use a SQL injection to steal or modify contents of the database. Instead, use a parameterized query which is available by default in most database engines. Alternatively, consider using the Django object-relational mappers (ORM) instead of raw SQL queries.", "evidence": "requires login", "fix_suggestion": "Review and fix the security issue", "risk_score": 9.0, "component": null, "status": "OPEN", "manual_review": {}, "reviewer_comments": [], "created_at": "2025-11-20T05:47:22.801488", "updated_at": null}, {"id": "SEMGREP-58f7f85e", "tool": "semgrep", "language": "sqlalchemy", "file": "app.py", "line": 36, "cwe": "CWE-CWE-704: Incorrect Type Conversion or Cast", "severity": "HIGH", "description": "Detected user input used to manually construct a SQL string. This is usually bad practice because manual construction could accidentally result in a SQL injection. An attacker could use a SQL injection to steal or modify contents of the database. Instead, use a parameterized query which is available by default in most database engines. Alternatively, consider using an object-relational mapper (ORM) such as SQLAlchemy which will protect your queries.", "evidence": "requires login", "fix_suggestion": "Review and fix the security issue", "risk_score": 9.0, "component": null, "status": "OPEN", "manual_review": {}, "reviewer_comments": [], "created_at": "2025-11-20T05:47:22.801715", "updated_at": null}, {"id": "SEMGREP-3d466f34", "tool": "semgrep", "language": "sqlalchemy", "file": "app.py", "line": 37, "cwe": "CWE-CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')", "severity": "HIGH", "description": "Avoiding SQL string concatenation: untrusted input concatenated with raw SQL query can result in SQL Injection. In order to execute raw query safely, prepared statement should be used. SQLAlchemy provides TextualSQL to easily used prepared statement with named parameters. For complex SQL composition, use SQL Expression Language or Schema Definition Language. In most cases, SQLAlchemy ORM will be a better option.", "evidence": "requires login", "fix_suggestion": "Review and fix the security issue", "risk_score": 9.0, "component": null, "status": "OPEN", "manual_review": {}, "reviewer_comments": [], "created_at": "2025-11-20T05:47:22.802185", "updated_at": null}, {"id": "SEMGREP-b44a0491", "tool": "semgrep", "language": "django", "file": "app.py", "line": 44, "cwe": "CWE-CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')", "severity": "HIGH", "description": "Request data detected in os.system. This could be vulnerable to a command injection and should be avoided. If this must be done, use the 'subprocess' module instead and pass the arguments as a list. See https://owasp.org/www-community/attacks/Command_Injection for more information.", "evidence": "requires login", "fix_suggestion": "Review and fix the security issue", "risk_score": 9.0, "component": null, "status": "OPEN", "manual_review": {}, "reviewer_comments": [], "created_at": "2025-11-20T05:47:22.802716", "updated_at": null}, {"id": "SEMGREP-1efb0c72", "tool": "semgrep", "language": "flask", "file": "app.py", "line": 45, "cwe": "CWE-CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')", "severity": "HIGH", "description": "User data detected in os.system. This could be vulnerable to a command injection and should be avoided. If this must be done, use the 'subprocess' module instead and pass the arguments as a list.", "evidence": "requires login", "fix_suggestion": "Review and fix the security issue", "risk_score": 9.0, "component": null, "status": "OPEN", "manual_review": {}, "reviewer_comments": [], "created_at": "2025-11-20T05:47:22.803711", "updated_at": null}, {"id": "SEMGREP-fbbebd1c", "tool": "semgrep", "language": "python", "file": "app.py", "line": 45, "cwe": "CWE-CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')", "severity": "HIGH", "description": "Found user-controlled data used in a system call. This could allow a malicious actor to execute commands. Use the 'subprocess' module instead, which is easier to use without accidentally exposing a command injection vulnerability.", "evidence": "requires login", "fix_suggestion": "Review and fix the security issue", "risk_score": 9.0, "component": null, "status": "OPEN", "manual_review": {}, "reviewer_comments": [], "created_at": "2025-11-20T05:47:22.803983", "updated_at": null}, {"id": "SEMGREP-14b50201", "tool": "semgrep", "language": "flask", "file": "app.py", "line": 51, "cwe": "CWE-CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')", "severity": "HIGH", "description": "Detected user input entering a `subprocess` call unsafely. This could result in a command injection vulnerability. An attacker could use this vulnerability to execute arbitrary commands on the host, which allows them to download malware, scan sensitive data, or run any command they wish on the server. Do not let users choose the command to run. In general, prefer to use Python API versions of system commands. If you must use subprocess, use a dictionary to allowlist a set of commands.", "evidence": "requires login", "fix_suggestion": "Review and fix the security issue", "risk_score": 9.0, "component": null, "status": "OPEN", "manual_review": {}, "reviewer_comments": [], "created_at": "2025-11-20T05:47:22.804152", "updated_at": null}, {"id": "SEMGREP-adc4f7a9", "tool": "semgrep", "language": "python", "file": "app.py", "line": 51, "cwe": "CWE-CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')", "severity": "HIGH", "description": "Detected subprocess function 'check_output' with user controlled data. A malicious actor could leverage this to perform command injection. You may consider using 'shlex.escape()'.", "evidence": "requires login", "fix_suggestion": "Review and fix the security issue", "risk_score": 9.0, "component": null, "status": "OPEN", "manual_review": {}, "reviewer_comments": [], "created_at": "2025-11-20T05:47:22.804320", "updated_at": null}, {"id": "SEMGREP-140ce9d2", "tool": "semgrep", "language": "python", "file": "app.py", "line": 51, "cwe": "CWE-CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')", "severity": "HIGH", "description": "Found 'subprocess' function 'check_output' with 'shell=True'. This is dangerous because this call will spawn the command using a shell process. Doing so propagates current shell settings and variables, which makes it much easier for a malicious actor to execute commands. Use 'shell=False' instead.", "evidence": "requires login", "fix_suggestion": "Review and fix the security issue", "risk_score": 9.0, "component": null, "status": "OPEN", "manual_review": {}, "reviewer_comments": [], "created_at": "2025-11-20T05:47:22.804470", "updated_at": null}, {"id": "SEMGREP-3bdaa142", "tool": "semgrep", "language": "flask", "file": "app.py", "line": 57, "cwe": "CWE-CWE-502: Deserialization of Untrusted Data", "severity": "HIGH", "description": "Detected the use of an insecure deserialization library in a Flask route. These libraries are prone to code execution vulnerabilities. Ensure user data does not enter this function. To fix this, try to avoid serializing whole objects. Consider instead using a serializer such as JSON.", "evidence": "requires login", "fix_suggestion": "Review and fix the security issue", "risk_score": 9.0, "component": null, "status": "OPEN", "manual_review": {}, "reviewer_comments": [], "created_at": "2025-11-20T05:47:22.804612", "updated_at": null}, {"id": "SEMGREP-fbf4e302", "tool": "semgrep", "language": "flask", "file": "app.py", "line": 63, "cwe": "CWE-CWE-96: Improper Neutralization of Directives in Statically Saved Code ('Static Code Injection')", "severity": "HIGH", "description": "Found a template created with string formatting. This is susceptible to server-side template injection and cross-site scripting attacks.", "evidence": "requires login", "fix_suggestion": "Review and fix the security issue", "risk_score": 9.0, "component": null, "status": "OPEN", "manual_review": {}, "reviewer_comments": [], "created_at": "2025-11-20T05:47:22.805108", "updated_at": null}, {"id": "SEMGREP-31b77f34", "tool": "semgrep", "language": "flask", "file": "app.py", "line": 69, "cwe": "CWE-CWE-95: Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection')", "severity": "HIGH", "description": "Detected user data flowing into eval. This is code injection and should be avoided.", "evidence": "requires login", "fix_suggestion": "Review and fix the security issue", "risk_score": 9.0, "component": null, "status": "OPEN", "manual_review": {}, "reviewer_comments": [], "created_at": "2025-11-20T05:47:22.806163", "updated_at": null}, {"id": "BANDIT-53916c51", "tool": "bandit", "language": "python", "file": "app.py", "line": 82, "cwe": "CWE-94", "severity": "HIGH", "description": "A Flask app appears to be run with debug=True, which exposes the Werkzeug debugger and allows the execution of arbitrary code. (Test: flask_debug_true)", "evidence": "81 \n82     app.run(host='0.0.0.0', port=5000, debug=True)\n", "fix_suggestion": "https://bandit.readthedocs.io/en/1.9.1/plugins/b201_flask_debug_true.html", "risk_score": 9.0, "component": null, "status": "OPEN", "manual_review": {}, "reviewer_comments": [], "created_at": "2025-11-20T05:46:48.767606", "updated_at": null}, {"id": "BANDIT-d3f60d32", "tool": "bandit", "language": "python", "file": "app.py", "line": 25, "cwe": "CWE-89", "severity": "MEDIUM", "description": "Possible SQL injection vector through string-based query construction. (Test: hardcoded_sql_expressions)", "evidence": "24     cursor = conn.cursor()\n25     query = f\"SELECT * FROM users WHERE id = {user_id}\"\n26     cursor.execute(query)\n", "fix_suggestion": "https://bandit.readthedocs.io/en/1.9.1/plugins/b608_hardcoded_sql_expressions.html", "risk_score": 8.1, "component": null, "status": "OPEN", "manual_review": {}, "reviewer_comments": [], "created_at": "2025-11-20T05:46:48.766876", "updated_at": null}, {"id": "BANDIT-ae851ede", "tool": "bandit", "language": "python", "file": "app.py", "line": 36, "cwe": "CWE-89", "severity": "MEDIUM", "description": "Possible SQL injection vector through string-based query construction. (Test: hardcoded_sql_expressions)", "evidence": "35     cursor = conn.cursor()\n36     sql = f\"SELECT * FROM products WHERE name LIKE '%{query}%'\"\n37     cursor.execute(sql)\n", "fix_suggestion": "https://bandit.readthedocs.io/en/1.9.1/plugins/b608_hardcoded_sql_expressions.html", "risk_score": 8.1, "component": null, "status": "OPEN", "manual_review": {}, "reviewer_comments": [], "created_at": "2025-11-20T05:46:48.766992", "updated_at": null}, {"id": "BANDIT-c92ad421", "tool": "bandit", "language": "python", "file": "app.py", "line": 69, "cwe": "CWE-78", "severity": "MEDIUM", "description": "Use of possibly insecure function - consider using safer ast.literal_eval. (Test: blacklist)", "evidence": "68     expr = request.args.get('expr', '1+1')\n69     result = eval(expr)\n70     return jsonify({\"result\": result})\n", "fix_suggestion": "https://bandit.readthedocs.io/en/1.9.1/blacklists/blacklist_calls.html#b307-eval", "risk_score": 8.1, "component": null, "status": "OPEN", "manual_review": {}, "reviewer_comments": [], "created_at": "2025-11-20T05:46:48.767490", "updated_at": null}, {"id": "BANDIT-4f3eefa8", "tool": "bandit", "language": "python", "file": "app.py", "line": 57, "cwe": "CWE-502", "severity": "MEDIUM", "description": "Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue. (Test: blacklist)", "evidence": "56     data = request.get_data()\n57     obj = pickle.loads(data)\n58     return jsonify({\"result\": str(obj)})\n", "fix_suggestion": "https://bandit.readthedocs.io/en/1.9.1/blacklists/blacklist_calls.html#b301-pickle", "risk_score": 7.65, "component": null, "status": "OPEN", "manual_review": {}, "reviewer_comments": [], "created_at": "2025-11-20T05:46:48.767376", "updated_at": null}, {"id": "SEMGREP-567fa38d", "tool": "semgrep", "language": "django", "file": "app.py", "line": 68, "cwe": "CWE-CWE-95: Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection')", "severity": "MEDIUM", "description": "Found user data in a call to 'eval'. This is extremely dangerous because it can enable an attacker to execute arbitrary remote code on the system. Instead, refactor your code to not use 'eval' and instead use a safe library for the specific functionality you need.", "evidence": "requires login", "fix_suggestion": "Review and fix the security issue", "risk_score": 6.75, "component": null, "status": "OPEN", "manual_review": {}, "reviewer_comments": [], "created_at": "2025-11-20T05:47:22.805970", "updated_at": null}, {"id": "SEMGREP-cd77c940", "tool": "semgrep", "language": "flask", "file": "app.py", "line": 82, "cwe": "CWE-CWE-668: Exposure of Resource to Wrong Sphere", "severity": "MEDIUM", "description": "Running flask app with host 0.0.0.0 could expose the server publicly.", "evidence": "requires login", "fix_suggestion": "Review and fix the security issue", "risk_score": 6.75, "component": null, "status": "OPEN", "manual_review": {}, "reviewer_comments": [], "created_at": "2025-11-20T05:47:22.806548", "updated_at": null}, {"id": "SEMGREP-71a4e7ae", "tool": "semgrep", "language": "flask", "file": "app.py", "line": 8, "cwe": "CWE-CWE-489: Active Debug Code", "severity": "MEDIUM", "description": "Hardcoded variable `DEBUG` detected. Set this by using FLASK_DEBUG environment variable", "evidence": "requires login", "fix_suggestion": "Review and fix the security issue", "risk_score": 4.5, "component": null, "status": "OPEN", "manual_review": {}, "reviewer_comments": [], "created_at": "2025-11-20T05:47:22.800173", "updated_at": null}, {"id": "SEMGREP-c12c8c3e", "tool": "semgrep", "language": "python", "file": "app.py", "line": 26, "cwe": "CWE-CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')", "severity": "MEDIUM", "description": "Detected possible formatted SQL query. Use parameterized queries instead.", "evidence": "requires login", "fix_suggestion": "Review and fix the security issue", "risk_score": 4.5, "component": null, "status": "OPEN", "manual_review": {}, "reviewer_comments": [], "created_at": "2025-11-20T05:47:22.800758", "updated_at": null}, {"id": "SEMGREP-09d57ac8", "tool": "semgrep", "language": "django", "file": "app.py", "line": 33, "cwe": "CWE-CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')", "severity": "MEDIUM", "description": "User-controlled data from a request is passed to 'execute()'. This could lead to a SQL injection and therefore protected information could be leaked. Instead, use django's QuerySets, which are built with query parameterization and therefore not vulnerable to sql injection. For example, you could use `Entry.objects.filter(date=2006)`.", "evidence": "requires login", "fix_suggestion": "Review and fix the security issue", "risk_score": 4.5, "component": null, "status": "OPEN", "manual_review": {}, "reviewer_comments": [], "created_at": "2025-11-20T05:47:22.801268", "updated_at": null}, {"id": "SEMGREP-dcf365ba", "tool": "semgrep", "language": "python", "file": "app.py", "line": 37, "cwe": "CWE-CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')", "severity": "MEDIUM", "description": "Detected possible formatted SQL query. Use parameterized queries instead.", "evidence": "requires login", "fix_suggestion": "Review and fix the security issue", "risk_score": 4.5, "component": null, "status": "OPEN", "manual_review": {}, "reviewer_comments": [], "created_at": "2025-11-20T05:47:22.801941", "updated_at": null}, {"id": "SEMGREP-57151575", "tool": "semgrep", "language": "python", "file": "app.py", "line": 57, "cwe": "CWE-CWE-502: Deserialization of Untrusted Data", "severity": "MEDIUM", "description": "Avoid using `pickle`, which is known to lead to code execution vulnerabilities. When unpickling, the serialized data could be manipulated to run arbitrary code. Instead, consider serializing the relevant data as JSON or a similar text-based serialization format.", "evidence": "requires login", "fix_suggestion": "Review and fix the security issue", "risk_score": 4.5, "component": null, "status": "OPEN", "manual_review": {}, "reviewer_comments": [], "created_at": "2025-11-20T05:47:22.804756", "updated_at": null}, {"id": "SEMGREP-5cb88eec", "tool": "semgrep", "language": "django", "file": "app.py", "line": 63, "cwe": "CWE-CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')", "severity": "MEDIUM", "description": "Detected user input flowing into a manually constructed HTML string. You may be accidentally bypassing secure methods of rendering HTML by manually constructing HTML and this could create a cross-site scripting vulnerability, which could let attackers steal sensitive user data. To be sure this is safe, check that the HTML is rendered safely. Otherwise, use templates (`django.shortcuts.render`) which will safely render HTML instead.", "evidence": "requires login", "fix_suggestion": "Review and fix the security issue", "risk_score": 4.5, "component": null, "status": "OPEN", "manual_review": {}, "reviewer_comments": [], "created_at": "2025-11-20T05:47:22.805349", "updated_at": null}, {"id": "SEMGREP-c7cf3497", "tool": "semgrep", "language": "flask", "file": "app.py", "line": 63, "cwe": "CWE-CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')", "severity": "MEDIUM", "description": "Detected user input flowing into a manually constructed HTML string. You may be accidentally bypassing secure methods of rendering HTML by manually constructing HTML and this could create a cross-site scripting vulnerability, which could let attackers steal sensitive user data. To be sure this is safe, check that the HTML is rendered safely. Otherwise, use templates (`flask.render_template`) which will safely render HTML instead.", "evidence": "requires login", "fix_suggestion": "Review and fix the security issue", "risk_score": 4.5, "component": null, "status": "OPEN", "manual_review": {}, "reviewer_comments": [], "created_at": "2025-11-20T05:47:22.805567", "updated_at": null}, {"id": "SEMGREP-cdbede8d", "tool": "semgrep", "language": "flask", "file": "app.py", "line": 64, "cwe": "CWE-CWE-96: Improper Neutralization of Directives in Statically Saved Code ('Static Code Injection')", "severity": "MEDIUM", "description": "Found a template created with string formatting. This is susceptible to server-side template injection and cross-site scripting attacks.", "evidence": "requires login", "fix_suggestion": "Review and fix the security issue", "risk_score": 4.5, "component": null, "status": "OPEN", "manual_review": {}, "reviewer_comments": [], "created_at": "2025-11-20T05:47:22.805766", "updated_at": null}, {"id": "SEMGREP-c659d0cb", "tool": "semgrep", "language": "python", "file": "app.py", "line": 69, "cwe": "CWE-CWE-95: Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection')", "severity": "MEDIUM", "description": "Detected the use of eval(). eval() can be dangerous if used to evaluate dynamic content. If this content can be input from outside the program, this may be a code injection vulnerability. Ensure evaluated content is not definable by external sources.", "evidence": "requires login", "fix_suggestion": "Review and fix the security issue", "risk_score": 4.5, "component": null, "status": "OPEN", "manual_review": {}, "reviewer_comments": [], "created_at": "2025-11-20T05:47:22.806354", "updated_at": null}, {"id": "SEMGREP-d67d51d9", "tool": "semgrep", "language": "flask", "file": "app.py", "line": 82, "cwe": "CWE-CWE-489: Active Debug Code", "severity": "MEDIUM", "description": "Detected Flask app with debug=True. Do not deploy to production with this flag enabled as it will leak sensitive information. Instead, consider using Flask configuration variables or setting 'debug' using system environment variables.", "evidence": "requires login", "fix_suggestion": "Review and fix the security issue", "risk_score": 4.5, "component": null, "status": "OPEN", "manual_review": {}, "reviewer_comments": [], "created_at": "2025-11-20T05:47:22.806797", "updated_at": null}, {"id": "BANDIT-54c89ca2", "tool": "bandit", "language": "python", "file": "app.py", "line": 82, "cwe": "CWE-605", "severity": "MEDIUM", "description": "Possible binding to all interfaces. (Test: hardcoded_bind_all_interfaces)", "evidence": "81 \n82     app.run(host='0.0.0.0', port=5000, debug=True)\n", "fix_suggestion": "https://bandit.readthedocs.io/en/1.9.1/plugins/b104_hardcoded_bind_all_interfaces.html", "risk_score": 4.5, "component": null, "status": "OPEN", "manual_review": {}, "reviewer_comments": [], "created_at": "2025-11-20T05:46:48.767719", "updated_at": null}, {"id": "RETIRE-MOCK-2", "tool": "retire.js", "language": null, "file": "C:\\Users\\MSI PC\\Workspace\\DevSecOps Automation Project\\ThreatModelerX\\demo-apps\\python-flask\\node_modules\\lodash\\lodash.js", "line": 1, "cwe": "CWE-1321", "severity": "MEDIUM", "description": "Prototype pollution in lodash before 4.17.12", "evidence": null, "fix_suggestion": "Update lodash to version 4.17.12 or later", "risk_score": 4.5, "component": null, "status": "OPEN", "manual_review": {}, "reviewer_comments": [], "created_at": "2025-11-20T05:46:45.163679", "updated_at": null}, {"id": "BANDIT-c4512c74", "tool": "bandit", "language": "python", "file": "app.py", "line": 5, "cwe": "CWE-78", "severity": "LOW", "description": "Consider possible security implications associated with the subprocess module. (Test: blacklist)", "evidence": "4 import pickle\n5 import subprocess\n6 \n", "fix_suggestion": "https://bandit.readthedocs.io/en/1.9.1/blacklists/blacklist_imports.html#b404-import-subprocess", "risk_score": 2.7, "component": null, "status": "OPEN", "manual_review": {}, "reviewer_comments": [], "created_at": "2025-11-20T05:46:48.766630", "updated_at": null}, {"id": "BANDIT-e45efd3d", "tool": "bandit", "language": "python", "file": "app.py", "line": 4, "cwe": "CWE-502", "severity": "LOW", "description": "Consider possible security implications associated with pickle module. (Test: blacklist)", "evidence": "3 import os\n4 import pickle\n5 import subprocess\n", "fix_suggestion": "https://bandit.readthedocs.io/en/1.9.1/blacklists/blacklist_imports.html#b403-import-pickle", "risk_score": 2.55, "component": null, "status": "OPEN", "manual_review": {}, "reviewer_comments": [], "created_at": "2025-11-20T05:46:48.766463", "updated_at": null}, {"id": "BANDIT-b9550a4b", "tool": "bandit", "language": "python", "file": "app.py", "line": 11, "cwe": "CWE-259", "severity": "LOW", "description": "Possible hardcoded password: 'admin123' (Test: hardcoded_password_string)", "evidence": "10 API_KEY = \"hardcoded_secret_key_12345\"\n11 DATABASE_PASSWORD = \"admin123\"\n12 \n", "fix_suggestion": "https://bandit.readthedocs.io/en/1.9.1/plugins/b105_hardcoded_password_string.html", "risk_score": 1.5, "component": null, "status": "OPEN", "manual_review": {}, "reviewer_comments": [], "created_at": "2025-11-20T05:46:48.766757", "updated_at": null}], "threats": [{"id": "THREAT-78a2498d", "category": "TAMPERING", "description": "Code injection via eval/exec", "component": "root", "attack_vector": "Attacker can execute arbitrary code", "mitre_ids": ["T1059"], "cwe_ids": ["CWE-95"], "risk_level": "HIGH", "manual_review": {}, "reviewer_comments": [], "created_at": "2025-11-20T05:47:22.824114", "updated_at": null, "mitigation": "Avoid using eval() or exec(). Use safer alternatives like ast.literal_eval() or JSON parsing."}, {"id": "THREAT-93c53d21", "category": "TAMPERING", "description": "Command injection vulnerability", "component": "root", "attack_vector": "Attacker can execute arbitrary system commands", "mitre_ids": ["T1059.004"], "cwe_ids": ["CWE-78"], "risk_level": "HIGH", "manual_review": {}, "reviewer_comments": [], "created_at": "2025-11-20T05:47:22.825151", "updated_at": null, "mitigation": "Use subprocess with argument lists instead of shell=True. Validate and sanitize all inputs."}, {"id": "THREAT-6837365b", "category": "TAMPERING", "description": "SQL injection vulnerability", "component": "root", "attack_vector": "Attacker can manipulate database queries", "mitre_ids": ["T1190"], "cwe_ids": ["CWE-89"], "risk_level": "CRITICAL", "manual_review": {}, "reviewer_comments": [], "created_at": "2025-11-20T05:47:22.826146", "updated_at": null, "mitigation": "Use parameterized queries or ORM methods. Never concatenate user input into SQL."}, {"id": "THREAT-5f22469f", "category": "INFORMATION_DISCLOSURE", "description": "Hardcoded credentials", "component": "root", "attack_vector": "Credentials exposed in source code", "mitre_ids": ["T1552.001"], "cwe_ids": ["CWE-798"], "risk_level": "CRITICAL", "manual_review": {}, "reviewer_comments": [], "created_at": "2025-11-20T05:47:22.827104", "updated_at": null, "mitigation": "Use environment variables or secure credential stores. Never hardcode secrets."}, {"id": "THREAT-124f420b", "category": "TAMPERING", "description": "Insecure deserialization", "component": "root", "attack_vector": "Attacker can execute code through crafted serialized objects", "mitre_ids": ["T1027"], "cwe_ids": ["CWE-502"], "risk_level": "HIGH", "manual_review": {}, "reviewer_comments": [], "created_at": "2025-11-20T05:47:22.827772", "updated_at": null, "mitigation": "Use safe deserialization methods like yaml.safe_load(). Validate serialized data."}, {"id": "THREAT-42ee0996", "category": "TAMPERING", "description": "Cross-site scripting (XSS) vulnerability", "component": "root", "attack_vector": "Attacker can inject malicious scripts", "mitre_ids": ["T1059.007"], "cwe_ids": ["CWE-79"], "risk_level": "MEDIUM", "manual_review": {}, "reviewer_comments": [], "created_at": "2025-11-20T05:47:22.828310", "updated_at": null, "mitigation": "Sanitize user input. Use framework-provided escaping mechanisms."}, {"id": "THREAT-e21b4845", "category": "INFORMATION_DISCLOSURE", "description": "Debug mode enabled", "component": "root", "attack_vector": "Sensitive information leaked in error messages", "mitre_ids": ["T1592"], "cwe_ids": ["CWE-489"], "risk_level": "MEDIUM", "manual_review": {}, "reviewer_comments": [], "created_at": "2025-11-20T05:47:22.829415", "updated_at": null, "mitigation": "Disable debug mode in production environments."}, {"id": "THREAT-95700b95", "category": "ELEVATION_OF_PRIVILEGE", "description": "Potential privilege escalation path", "component": "root", "attack_vector": "Administrative functionality detected", "mitre_ids": ["T1078"], "cwe_ids": ["CWE-250"], "risk_level": "LOW", "manual_review": {}, "reviewer_comments": [], "created_at": "2025-11-20T05:47:22.830472", "updated_at": null, "mitigation": "Implement proper access controls and role-based authorization."}], "summary": {"total_findings": 39, "by_severity": {"critical": 0, "high": 18, "medium": 18, "low": 3}, "by_tool": {"bandit": 11, "retire.js": 2, "semgrep": 26}, "total_threats": 8, "attack_graph": {"nodes": [{"id": "root", "data": {"node_type": "component"}}, {"id": "THREAT-78a2498d", "data": {"node_type": "threat", "category": "TAMPERING", "severity": "HIGH", "description": "Code injection via eval/exec"}}, {"id": "THREAT-93c53d21", "data": {"node_type": "threat", "category": "TAMPERING", "severity": "HIGH", "description": "Command injection vulnerability"}}, {"id": "THREAT-6837365b", "data": {"node_type": "threat", "category": "TAMPERING", "severity": "CRITICAL", "description": "SQL injection vulnerability"}}, {"id": "THREAT-5f22469f", "data": {"node_type": "threat", "category": "INFORMATION_DISCLOSURE", "severity": "CRITICAL", "description": "Hardcoded credentials"}}, {"id": "THREAT-124f420b", "data": {"node_type": "threat", "category": "TAMPERING", "severity": "HIGH", "description": "Insecure deserialization"}}, {"id": "THREAT-42ee0996", "data": {"node_type": "threat", "category": "TAMPERING", "severity": "MEDIUM", "description": "Cross-site scripting (XSS) vulnerability"}}, {"id": "THREAT-e21b4845", "data": {"node_type": "threat", "category": "INFORMATION_DISCLOSURE", "severity": "MEDIUM", "description": "Debug mode enabled"}}, {"id": "THREAT-95700b95", "data": {"node_type": "threat", "category": "ELEVATION_OF_PRIVILEGE", "severity": "LOW", "description": "Potential privilege escalation path"}}], "edges": [{"source": "THREAT-78a2498d", "target": "root", "data": {"relationship": "threatens"}}, {"source": "THREAT-93c53d21", "target": "root", "data": {"relationship": "threatens"}}, {"source": "THREAT-6837365b", "target": "root", "data": {"relationship": "threatens"}}, {"source": "THREAT-5f22469f", "target": "root", "data": {"relationship": "threatens"}}, {"source": "THREAT-124f420b", "target": "root", "data": {"relationship": "threatens"}}, {"source": "THREAT-42ee0996", "target": "root", "data": {"relationship": "threatens"}}, {"source": "THREAT-e21b4845", "target": "root", "data": {"relationship": "threatens"}}, {"source": "THREAT-95700b95", "target": "root", "data": {"relationship": "threatens"}}], "summary": {"total_components": 1, "total_threats": 8, "critical_threats": 2, "high_threats": 3}}}, "risk_score": 42.31}, "completed_at": "2025-11-20T05:47:24.073710", "progress": "100%", "expiry": "2025-11-21T05:47:24.073749"}, "SCAN-7adf823bf7eb": {"status": "completed", "result": {"scan_id": "SCAN-7adf823bf7eb", "repo_path": "C:\\Users\\MSI PC\\Workspace\\DevSecOps Automation Project\\ThreatModelerX\\demo-apps\\node-express", "timestamp": "2025-11-20T05:48:10.353954", "findings": [{"id": "RETIRE-MOCK-1", "tool": "retire.js", "language": null, "file": "C:\\Users\\MSI PC\\Workspace\\DevSecOps Automation Project\\ThreatModelerX\\demo-apps\\node-express\\node_modules\\jquery\\dist\\jquery.js", "line": 1, "cwe": "CWE-79", "severity": "HIGH", "description": "jQuery 1.8.1 vulnerable to XSS attacks", "evidence": null, "fix_suggestion": "Update jQuery to version 3.5.0 or later", "risk_score": 14.4, "component": null, "status": "OPEN", "manual_review": {}, "reviewer_comments": [], "created_at": "2025-11-20T05:47:41.891647", "updated_at": null}, {"id": "SEMGREP-5eb1e45c", "tool": "semgrep", "language": "javascript", "file": "app.js", "line": 19, "cwe": "CWE-CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')", "severity": "HIGH", "description": "Detected calls to child_process from a function argument `req`. This could lead to a command injection if the input is user controllable. Try to avoid calls to child_process, and if it is needed ensure user input is correctly sanitized or sandboxed. ", "evidence": "requires login", "fix_suggestion": "Review and fix the security issue", "risk_score": 9.0, "component": null, "status": "OPEN", "manual_review": {}, "reviewer_comments": [], "created_at": "2025-11-20T05:48:10.239718", "updated_at": null}, {"id": "SEMGREP-90fe5a1a", "tool": "semgrep", "language": "node.js", "file": "app.js", "line": 27, "cwe": "CWE-CWE-95: Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection')", "severity": "HIGH", "description": "Found data from an Express or Next web request flowing to `eval`. If this data is user-controllable this can lead to execution of arbitrary system commands in the context of your application process. Avoid `eval` whenever possible.", "evidence": "requires login", "fix_suggestion": "Review and fix the security issue", "risk_score": 9.0, "component": null, "status": "OPEN", "manual_review": {}, "reviewer_comments": [], "created_at": "2025-11-20T05:48:10.240273", "updated_at": null}, {"id": "SEMGREP-6c078a32", "tool": "semgrep", "language": "browser", "file": "app.js", "line": 27, "cwe": "CWE-CWE-95: Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection')", "severity": "MEDIUM", "description": "Detected the use of eval(). eval() can be dangerous if used to evaluate dynamic content. If this content can be input from outside the program, this may be a code injection vulnerability. Ensure evaluated content is not definable by external sources.", "evidence": "requires login", "fix_suggestion": "Review and fix the security issue", "risk_score": 4.5, "component": null, "status": "OPEN", "manual_review": {}, "reviewer_comments": [], "created_at": "2025-11-20T05:48:10.240008", "updated_at": null}, {"id": "SEMGREP-12319547", "tool": "semgrep", "language": "express", "file": "app.js", "line": 53, "cwe": "CWE-CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')", "severity": "MEDIUM", "description": "User data flows into the host portion of this manually-constructed HTML. This can introduce a Cross-Site-Scripting (XSS) vulnerability if this comes from user-provided input. Consider using a sanitization library such as DOMPurify to sanitize the HTML within.", "evidence": "requires login", "fix_suggestion": "Review and fix the security issue", "risk_score": 4.5, "component": null, "status": "OPEN", "manual_review": {}, "reviewer_comments": [], "created_at": "2025-11-20T05:48:10.240524", "updated_at": null}, {"id": "SEMGREP-b0f6b473", "tool": "semgrep", "language": "express", "file": "app.js", "line": 54, "cwe": "CWE-CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')", "severity": "MEDIUM", "description": "Detected directly writing to a Response object from user-defined input. This bypasses any HTML escaping and may expose your application to a Cross-Site-scripting (XSS) vulnerability. Instead, use 'resp.render()' to render safely escaped HTML.", "evidence": "requires login", "fix_suggestion": "Review and fix the security issue", "risk_score": 4.5, "component": null, "status": "OPEN", "manual_review": {}, "reviewer_comments": [], "created_at": "2025-11-20T05:48:10.240768", "updated_at": null}, {"id": "RETIRE-MOCK-2", "tool": "retire.js", "language": null, "file": "C:\\Users\\MSI PC\\Workspace\\DevSecOps Automation Project\\ThreatModelerX\\demo-apps\\node-express\\node_modules\\lodash\\lodash.js", "line": 1, "cwe": "CWE-1321", "severity": "MEDIUM", "description": "Prototype pollution in lodash before 4.17.12", "evidence": null, "fix_suggestion": "Update lodash to version 4.17.12 or later", "risk_score": 4.5, "component": null, "status": "OPEN", "manual_review": {}, "reviewer_comments": [], "created_at": "2025-11-20T05:47:41.891769", "updated_at": null}, {"id": "SEMGREP-1030c5e0", "tool": "semgrep", "language": "javascript", "file": "app.js", "line": 2, "cwe": "CWE-CWE-352: Cross-Site Request Forgery (CSRF)", "severity": "LOW", "description": "A CSRF middleware was not detected in your express application. Ensure you are either using one such as `csurf` or `csrf` (see rule references) and/or you are properly doing CSRF validation in your routes with a token or cookies.", "evidence": "requires login", "fix_suggestion": "Review and fix the security issue", "risk_score": 1.5, "component": null, "status": "OPEN", "manual_review": {}, "reviewer_comments": [], "created_at": "2025-11-20T05:48:10.239407", "updated_at": null}], "threats": [{"id": "THREAT-7ca4f4ea", "category": "TAMPERING", "description": "Code injection via eval/exec", "component": "root", "attack_vector": "Attacker can execute arbitrary code", "mitre_ids": ["T1059"], "cwe_ids": ["CWE-95"], "risk_level": "HIGH", "manual_review": {}, "reviewer_comments": [], "created_at": "2025-11-20T05:48:10.313518", "updated_at": null, "mitigation": "Avoid using eval() or exec(). Use safer alternatives like ast.literal_eval() or JSON parsing."}, {"id": "THREAT-86955d9b", "category": "INFORMATION_DISCLOSURE", "description": "Hardcoded credentials", "component": "root", "attack_vector": "Credentials exposed in source code", "mitre_ids": ["T1552.001"], "cwe_ids": ["CWE-798"], "risk_level": "CRITICAL", "manual_review": {}, "reviewer_comments": [], "created_at": "2025-11-20T05:48:10.314494", "updated_at": null, "mitigation": "Use environment variables or secure credential stores. Never hardcode secrets."}, {"id": "THREAT-f6c01b57", "category": "INFORMATION_DISCLOSURE", "description": "Overly permissive CORS policy", "component": "root", "attack_vector": "Any origin can access sensitive data", "mitre_ids": ["T1557"], "cwe_ids": ["CWE-942"], "risk_level": "MEDIUM", "manual_review": {}, "reviewer_comments": [], "created_at": "2025-11-20T05:48:10.315128", "updated_at": null, "mitigation": "Restrict CORS to specific trusted origins. Avoid wildcard (*) in production."}, {"id": "THREAT-f1970a4f", "category": "SPOOFING", "description": "Weak random number generation", "component": "root", "attack_vector": "Predictable random values for security-sensitive operations", "mitre_ids": ["T1552"], "cwe_ids": ["CWE-338"], "risk_level": "LOW", "manual_review": {}, "reviewer_comments": [], "created_at": "2025-11-20T05:48:10.315433", "updated_at": null, "mitigation": "Use cryptographically secure random generators (secrets module, crypto.randomBytes)."}, {"id": "THREAT-2bf6d02c", "category": "ELEVATION_OF_PRIVILEGE", "description": "Potential privilege escalation path", "component": "root", "attack_vector": "Administrative functionality detected", "mitre_ids": ["T1078"], "cwe_ids": ["CWE-250"], "risk_level": "LOW", "manual_review": {}, "reviewer_comments": [], "created_at": "2025-11-20T05:48:10.315512", "updated_at": null, "mitigation": "Implement proper access controls and role-based authorization."}], "summary": {"total_findings": 8, "by_severity": {"critical": 0, "high": 3, "medium": 4, "low": 1}, "by_tool": {"retire.js": 2, "semgrep": 6}, "total_threats": 5, "attack_graph": {"nodes": [{"id": "root", "data": {"node_type": "component"}}, {"id": "THREAT-7ca4f4ea", "data": {"node_type": "threat", "category": "TAMPERING", "severity": "HIGH", "description": "Code injection via eval/exec"}}, {"id": "THREAT-86955d9b", "data": {"node_type": "threat", "category": "INFORMATION_DISCLOSURE", "severity": "CRITICAL", "description": "Hardcoded credentials"}}, {"id": "THREAT-f6c01b57", "data": {"node_type": "threat", "category": "INFORMATION_DISCLOSURE", "severity": "MEDIUM", "description": "Overly permissive CORS policy"}}, {"id": "THREAT-f1970a4f", "data": {"node_type": "threat", "category": "SPOOFING", "severity": "LOW", "description": "Weak random number generation"}}, {"id": "THREAT-2bf6d02c", "data": {"node_type": "threat", "category": "ELEVATION_OF_PRIVILEGE", "severity": "LOW", "description": "Potential privilege escalation path"}}], "edges": [{"source": "THREAT-7ca4f4ea", "target": "root", "data": {"relationship": "threatens"}}, {"source": "THREAT-86955d9b", "target": "root", "data": {"relationship": "threatens"}}, {"source": "THREAT-f6c01b57", "target": "root", "data": {"relationship": "threatens"}}, {"source": "THREAT-f1970a4f", "target": "root", "data": {"relationship": "threatens"}}, {"source": "THREAT-2bf6d02c", "target": "root", "data": {"relationship": "threatens"}}], "summary": {"total_components": 1, "total_threats": 5, "critical_threats": 1, "high_threats": 1}}}, "risk_score": 38.75}, "completed_at": "2025-11-20T05:48:10.370842", "progress": "100%", "expiry": "2025-11-21T05:48:10.370869"}}